(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-550f0622"],{6633:function(e,r,t){"use strict";t.r(r);var i=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"addImage global_div"},[t("content-top",{attrs:{titlename:"添加属性"}}),t("div",{staticClass:"center_div"},[t("el-form",{ref:"ruleForm",staticClass:"form",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[t("el-form-item",{attrs:{label:"相册名称: ",prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(r){e.$set(e.ruleForm,"name",r)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:"相册封面: ",prop:"cover"}},[e.ruleForm.cover?t("img",{staticClass:"form-img",attrs:{src:e.ruleForm.cover,alt:""}}):e._e(),t("div",{staticClass:"upload-btn-wrap"},[t("label",{attrs:{for:"upload"}},[t("el-button",{attrs:{type:"primary",size:"small"}},[e._v("上传图片")])],1),t("input",{staticClass:"upload-input",attrs:{id:"upload",type:"file",accept:"image/jpeg, image/png"},on:{change:e.uploadLogo}}),t("p",{staticClass:"form-tips"},[e._v("只能上传jpg/png格式文件，文件不能超过50kb")])])]),t("el-form-item",{attrs:{label:"排序: ",prop:"sorting"}},[t("el-input",{attrs:{type:"number"},model:{value:e.ruleForm.sorting,callback:function(r){e.$set(e.ruleForm,"sorting",r)},expression:"ruleForm.sorting"}})],1),t("el-form-item",{attrs:{label:"相册描述: ",prop:"description"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.description,callback:function(r){e.$set(e.ruleForm,"description",r)},expression:"ruleForm.description"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(r){e.submitForm("ruleForm")}}},[e._v("提交")]),t("el-button",{on:{click:function(r){e.$router.push({name:"goodsimage"})}}},[e._v("返回")])],1)],1)],1)],1)},o=[],s=t("5c96"),a={name:"addimage",data(){let e=(e,r,t)=>{this.ruleForm.cover?t():t(new Error("请上传相册封面"))};return{ruleForm:{name:"",cover:"",sorting:"",description:""},rules:{name:[{required:!0,message:"请输入相册名称",trigger:"blur"},{max:20,message:"长度必须小于20个字符",trigger:"blur"}],cover:[{validator:e,required:!0,trigger:"change"}]},isAdd:!0}},created(){this.$route.query.id&&this.$http.post("merchant_goods_galleries/query_by_id",{id:this.$route.query.id},{type:"form"}).then(e=>{this.isAdd=!1,this.ruleForm.name=e.name,this.ruleForm.cover=e.cover,this.ruleForm.sorting=e.sorting,this.ruleForm.description=e.description},e=>{s["Message"].error(e.msg)})},methods:{submitForm(e){this.$refs[e].validate(e=>{if(!e)return!1;this.isAdd?this.addEdit("merchant_goods_galleries/add"):(this.ruleForm.id=this.$route.query.id,this.addEdit("merchant_goods_galleries/update"))})},addEdit(e){this.$http.post(e,this.ruleForm).then(()=>{s["Message"].success("提交成功"),setTimeout(()=>{this.$router.push("/index/goodsimage")},500)},e=>{s["Message"].error(e.msg)})},uploadFile(e){return new Promise((r,t)=>{if(e.target.files.length>0){let i=new FormData;i.append("file",e.target.files[0]),this.$http.post("merchant/upload_file",i,{type:"form",file:"image"}).then(e=>{r({imgUrl:e.imgUrl+e.image})},e=>{s["Message"].error(e.msg),t(e)})}})},uploadLogo(e){this.uploadFile(e).then(e=>{this.ruleForm.logo=e.imgUrl})},uploadAreaLogo(e){this.uploadFile(e).then(e=>{this.ruleForm.areaLogo=e.imgUrl})}}},l=a,n=(t("aa1a"),t("2877")),m=Object(n["a"])(l,i,o,!1,null,"8d5bcf6a",null);m.options.__file="addImage.vue";r["default"]=m.exports},aa1a:function(e,r,t){"use strict";var i=t("b932"),o=t.n(i);o.a},b932:function(e,r,t){}}]);
//# sourceMappingURL=chunk-550f0622.2bfc1b58.js.map