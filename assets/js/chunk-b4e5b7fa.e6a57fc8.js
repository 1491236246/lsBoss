(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b4e5b7fa"],{"2e0b":function(e,o,t){},"69b8":function(e,o,t){"use strict";var r=t("2e0b"),s=t.n(r);s.a},dea2:function(e,o,t){"use strict";t.r(o);var r=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"global_div proAddlist"},[t("content-top",{attrs:{titlename:"类目列表"}}),t("div",{staticClass:"center_div"},[t("el-form",{ref:"ruleForm",staticClass:"form",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"150px"}},[t("el-form-item",{attrs:{label:"拼团商品: ",prop:"goodsId"}},[t("el-select",{ref:"searchSelect",attrs:{filterable:"",remote:"",clearable:"",disabled:!e.isAdd,placeholder:"请输入商品名","remote-method":e.searchGoods},on:{change:e.handleGoods},model:{value:e.ruleForm.goodsId,callback:function(o){e.$set(e.ruleForm,"goodsId",o)},expression:"ruleForm.goodsId"}},e._l(e.goodsList,function(e){return t("el-option",{attrs:{label:e.goodsName,value:e.id}})}),1)],1),e.specList.length>0?t("el-form-item",{attrs:{label:"选择商品规格: ",prop:"skuId"}},e._l(e.specList,function(o){return t("div",{staticClass:"spec-item"},[t("el-radio",{attrs:{label:o.id,border:"",size:"medium"},model:{value:e.ruleForm.skuId,callback:function(o){e.$set(e.ruleForm,"skuId",o)},expression:"ruleForm.skuId"}},[e._l(o.nameValue,function(o){return t("span",{staticClass:"spec-info"},[e._v(e._s(o.name+":"+o.value))])}),t("span",{staticClass:"spec-info"},[e._v("价格: "+e._s(o.goodsSalePrice))]),t("span",{staticClass:"spec-info"},[e._v("库存: "+e._s(o.goodsStock))])],2)],1)}),0):e._e(),e.ruleForm.skuId?t("el-form-item",{attrs:{label:"拼团规格设置: "}},[t("table",{staticClass:"goods-table",attrs:{border:"1"}},[t("thead",[t("td",[e._v("拼团人数")]),t("td",[e._v("拼团价格")]),t("td",[e._v("拼团时效")]),t("td",[e._v("成团个数")]),t("td",[e._v("操作")])]),t("tbody",e._l(e.ruleForm.merchantGoodsGroup,function(o,r){return t("tr",[t("td",[t("el-select",{attrs:{placeholder:"请选择人数",size:"small"},model:{value:o.groupUserNum,callback:function(t){e.$set(o,"groupUserNum",t)},expression:"item.groupUserNum"}},e._l([2,4,6],function(e){return t("el-option",{attrs:{label:e,value:e}})}),1)],1),t("td",[t("el-input",{attrs:{type:"number",min:"0",placeholder:"团价格不能相同",size:"small"},model:{value:o.groupPrice,callback:function(t){e.$set(o,"groupPrice",t)},expression:"item.groupPrice"}})],1),t("td",[t("el-select",{attrs:{placeholder:"请选择时间",size:"small"},model:{value:o.groupTime,callback:function(t){e.$set(o,"groupTime",t)},expression:"item.groupTime"}},[t("el-option",{attrs:{label:"12小时制",value:"12"}}),t("el-option",{attrs:{label:"24小时制",value:"24"}})],1)],1),t("td",[t("el-input",{attrs:{type:"number",min:"0",placeholder:"最多100个团",size:"small"},model:{value:o.groupMaxNum,callback:function(t){e.$set(o,"groupMaxNum",t)},expression:"item.groupMaxNum"}})],1),t("td",[t("el-button",{attrs:{type:"text",disabled:e.ruleForm.merchantGoodsGroup.length<2},on:{click:function(o){e.deleteSpec(r)}}},[e._v("删除")])],1)])}),0)]),e.ruleForm.merchantGoodsGroup.length<4&&e.isAdd?t("el-button",{staticClass:"add-spec-btn",on:{click:e.addSpec}},[e._v("添加规格（最多添加四个）")]):e._e()],1):e._e(),t("el-form-item",[t("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:function(o){e.submitForm("ruleForm")}}},[e._v("提交")]),t("el-button",{on:{click:function(o){e.$router.push({name:"proList"})}}},[e._v("返回")])],1)],1)],1)],1)},s=[],i=t("5c96"),a={name:"proAddlist",data(){return{isAdd:!0,goodsList:[],goodsId:"",specList:[],ruleForm:{goodsId:"",skuId:"",merchantGoodsGroup:[{groupUserNum:"",groupPrice:"",groupTime:"",groupMaxNum:""}]},rules:{goodsId:[{required:!0,message:"请选择拼团商品",trigger:"change"}],skuId:[{required:!0,message:"请选择商品规格"}],merchantGoodsGroup:[{required:!0}]},loading:!1,submitLoading:!1}},created(){this.$route.query.id?(this.isAdd=!1,this.loading=!0,this.$http.post("merchantGoodsGroup/goods_group_by_id",{id:this.$route.query.id}).then(e=>{this.goodsId=e.merchantGoods.id,this.$set(this.ruleForm,"goodsId",e.merchantGoods.goodsName),this.$set(this.ruleForm,"skuId",e.merchantGoodsTypeProperty.id),this.$set(this.ruleForm,"merchantGoodsGroup",[{groupUserNum:e.groupUserNum,groupPrice:e.groupPrice,groupTime:e.groupTime,groupMaxNum:e.groupMaxNum}]),this.specList=[{id:e.merchantGoodsTypeProperty.id,nameValue:e.merchantGoodsTypeProperty.nameValue,goodsSalePrice:e.merchantGoodsTypeProperty.goodsSalePrice,goodsStock:e.merchantGoodsTypeProperty.goodsStock}]},e=>{i["Message"].error(e.msg),this.loading=!1})):this.isAdd=!0},methods:{addSpec(){this.ruleForm.merchantGoodsGroup.push({groupUserNum:"",groupPrice:"",groupTime:"",groupMaxNum:""})},deleteSpec(e){this.ruleForm.merchantGoodsGroup.length>1&&this.ruleForm.merchantGoodsGroup.splice(e,1)},submitForm(e){this.$refs[e].validate(e=>{if(!e)return!1;{let e=!0;if(this.ruleForm.merchantGoodsGroup.forEach(o=>{return o.groupUserNum&&o.groupPrice&&o.groupTime&&o.groupMaxNum?o.groupMaxNum>100||o.groupMaxNum<0?(i["Message"].warning("成团个数在0到100之间"),void(e=!1)):void 0:(i["Message"].warning("请填写完整拼团规格列表"),void(e=!1))}),!e)return;this.submitLoading=!0,this.isAdd?this.addEdit("merchantGoodsGroup/goods_group_add"):(this.ruleForm.goodsId=String(this.goodsId),this.ruleForm.id=this.$route.query.id,this.ruleForm=Object.assign(this.ruleForm,this.ruleForm.merchantGoodsGroup[0]),delete this.ruleForm.merchantGoodsGroup,this.addEdit("merchantGoodsGroup/goods_group_update"))}})},addEdit(e){let o=Object.assign({},this.ruleForm);this.$http.post(e,o).then(()=>{i["Message"].success("提交成功"),setTimeout(()=>{this.$router.push("/promotion/list"),this.submitLoading=!1},500)},e=>{this.submitLoading=!1,i["Message"].error(e.msg)})},searchGoods(e){this.$http.post("merchantGoods/merchant_goods_list_page",{currentPage:1,pageSize:100,goodsName:e}).then(e=>{this.goodsList=e.list})},handleGoods(e){e&&(this.adLink=e.toString(),this.$http.post("merchantGoods/merchant_goods_by_id",{id:e}).then(e=>{this.specList=e.merchantGoodsTypePropertyList}))}}},d=a,u=(t("69b8"),t("2877")),l=Object(u["a"])(d,r,s,!1,null,"0d60b2e4",null);l.options.__file="proAddlist.vue";o["default"]=l.exports}}]);
//# sourceMappingURL=chunk-b4e5b7fa.e6a57fc8.js.map